<!DOCTYPE html>
<html>
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HXHT6KGZT3"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-HXHT6KGZT3');
    </script>
    
    <title>Shelving Designer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js" crossorigin></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.21.4/babel.min.js" crossorigin></script>
</head>

<body>
    <div id="root"></div>
    
    <!-- Load engine and components -->
    <script src="js/designer-engine.js"></script>
    <script type="text/babel" src="js/designer.jsx"></script>
    
    <!-- Simple initialization that waits for everything to load -->
    <script>
        function initDesigner() {
            try {
                if (window.ModuleBuilder && window.ReactDOM) {
                    const root = ReactDOM.createRoot(document.getElementById('root'));
                    root.render(React.createElement(window.ModuleBuilder));
                    console.log('Designer initialized successfully!');
                } else {
                    // Not loaded yet, wait a bit more
                    console.log('Waiting for scripts to load...');
                    setTimeout(initDesigner, 500);
                }
            } catch (err) {
                console.error('Error initializing designer:', err);
                document.getElementById('root').innerHTML = 
                    '<div style="padding: 20px; background-color: #f8d7da; color: #721c24; border-radius: 4px;">' +
                    '<h3>Failed to load designer</h3>' +
                    '<p>Please refresh the page. If the problem persists, contact support.</p>' +
                    '</div>';
            }
        }
        
        // Wait for page to fully load before initializing
        window.onload = function() {
            // Give Babel time to process everything
            setTimeout(initDesigner, 1000);
        };
    </script>
</body>
</html>